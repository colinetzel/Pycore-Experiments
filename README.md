# Node-to-node Chain Experiments with Common Open Research Emulator (CORE) Simulator #

## Description ##

Network traffic experiments with the python interface (pycore) for the Common Open Research Emulator. Network throughput is determined over a network topology of two nodes directly connected over a link with customizable bandwidth, delay, jitter, packet loss, packet duplication. Output of the experiments are saved to text files and plots with error bars are generated.

## Synopsis ##

**sudo python pycore_P2chain_graph.py** **[** _options_ **]**

**sudo python pycore_p2chain_graph_multiple.py** **[** _options_ **]**

## Shared Options ##
Both programs have the following options, italicized words are the format of the option to supply after the option declaration.

Option | Description
------ | -----------
-o _filename_ | Full filename of output graph (including .pdf or .png suffix). Default is no filename, causing a graph to be displayed at end instead of saving a graph if not specified by user.
-x _x-value_ | Value to be plotted on x axis (the independent variable). Valid options are **bandwidth** ,**delay**, **jitter**, **loss**, and **duplicate**, default is **bandwidth**
-i _interval_ | Interval between x-values, in units of said x-value. IE: bandwidth with -i 1 as interval varies by 1 Mb per step. Default value is 1 is not specified by user.
--length _experiment length_ | Number of x-values for experiment. This times the interval gives the domain of the experiment/resulting plot. Default value is 10 if not specified by user.
--bandwidth _megabits_ | Sets the bandwidth cap for the link (in Mb). Defaults to 1 Mb if not specified by user.
--delay _microseconds_ | Sets a delay for the link, in microseconds. Defaults to 0 us if not specified by user.
--jitter _microseconds_ | Sets a jitter for the link, in microseconds. Defaults to 0 us if not specified by user.
--duplicate _percentage_ | Sets the chance for a duplicate packet being generated for each packet sent. Defaults to 0% if not specified by user.
--numRuns _integer_ | Sets the number of times each data point is repeated to shrink error bars at value. Defaults to 1 if not specified by user, which results in no error bars in resulting graphs.
--server | Toggle to use server side logging instead of the default client side logging of experiments.

## Single Graph Options ##
Used in **pycore_P2chain_graph.py**

Option | Description
------ | -----------
-csv _filename_ | Name of output raw data file generated by script for use in graphing

## Multiple Graph Options ##
Used in **python pycore_p2chain_graph_multiple.py**

Option | Description
------ | -----------
N/A _csvs_ | Remaining arguments in command line are interpreted as csv files (generated from single mode) to be used in graph.

## Detailed Running Instructions ##
Both program commands require root privileges as CORE's python module requires it.

All experimental data is generated using **single graph mode (pycore_P2chain_graph.py)**. To determine the range of your experiment set the interval and the length, and the range of x-values will be generated automatically from i (index) * interval, with i starting from 0 and having a number of elements of the length attribute. For example a length of 5 and an interval of 3 for an x-value that is not bandwidth will find bandwidth across the link for x-values in the list [0,3,6,9,12].

**Note: for x-values of bandwidth only the index starts at 1, as zero values for bandwidth results in effectively infinite bandwidth in CORE.** So for the above length and interval with a bandwidth x-value will result in this list: [3,6,9,12,15]

The --bandwidth, --delay, --jitter, and --duplicate options allow you to set constant values to last throughout the experiment. --numRuns allows you to repeat each x-value numRuns number of times.

-csv should be set when generating data to be used multiple times or in the multiple graph mode. Using the same name as a currently existing csv file will result in the file being overwritten.

--server toggles whether the script records bandwidth from the server node or the client node (default is client). The server node is generally more accurate, particularly at the very first x-value, but client logging is significantly faster and still very accurate at x-values that are not the first x-value.

**multiple graph mode (pycore_p2chain_graph_multiple.py)** does not generate experimental data, instead using .csvs generated from single graph mode. It is important the x-value type, experiment length, interval, numRuns, and server option to be set the same as all .csvs used for data. As such the csvs should have been generated with said options constant across them. Following the csv naming convention below is recommended for multiple graphs especially.

### csv naming convention ###
The preferred format is the title followed by a dash (-) before the desired legend name for said graph. Example: "foo-bar.csv" has a title of foo and a legend name of bar. Legend entry names are optional, do not include a dash in the name if a legend is not desired, and titles should not contain dashes.

## Special -i values ##
Setting -i to -1 or -2 enables a special interval range, and overrides _experiment length_ to be 10.

### Special Log Scale ###
-i -1 is interpreted as using this range of **bandwidth** x-values: **[0.1,0.2,0.5,1,2,5,10,20,50,100]**. The resulting graph will be of the logarithm of the bandwidth x-values and the throughput y-values. Behavior for non-bandwidth x-values using this scale is not supported. The length attribute is set to the length of this array (10).

### Special Loss Scale ###
-i -2 is interpreted to use the following **loss** x-values: **[0.0,0.05,0.10,0.25,0.5,1.0,2.5,5.0]**. The length attribute is set to the length of this array (8).

## Dependencies and Installation ##
This software was developed on a Linux OS using the Debian software repository (Specific OS was Linux Mint 18.1 Serena, Cinammon 64-bit)

Requires a version of CORE and the core module available for python 2.7

### Setup ###
Open pycore_P2chain_graph.py and pycore_P2chain_graph_multiple.py and change the logPath variable to be wherever you want to store log (data .csv files) files on your machine. Ensure that all three .py files are in the directory.

### Python 2.7 3rd Party Modules ###
* argparse
* core
* matplotlib
* numpy
* pandas
* scipy

### Linux Programs ###
* core-daemon v.4.8
* core-gui v.4.8
* iperf 2.0.5 (08 Jul 2010) pthreads

